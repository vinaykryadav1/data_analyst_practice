[
  {
    "id": "sql1",
    "answer": "SELECT * FROM employees WHERE salary > 50000"
  },
  {
    "id": "sql2",
    "answer": "SELECT e.name, d.department_name FROM employees e JOIN departments d ON e.department_id = d.id;"
  },
  {
    "id": "sql3",
    "answer": "SELECT department_id, COUNT(*) AS total_employees FROM employees GROUP BY department_id;"
  },
  {
    "id": "sql4",
    "answer": "SELECT * FROM employees WHERE emp_name like 'A%'"
  },
  {
    "id": "sql5",
    "answer": "SELECT * FROM employees WHERE salary BETWEEN 40000 AND 80000;"
  },
  {
    "id": "sql6",
    "answer": "SELECT dept_name,COUNT(*) FROM employees GROUP BY dept_name;"
  },
  {
    "id": "sql7",
    "answer": "SELECT * FROM employees WHERE manager_id IS NULL"
  },
  {
    "id": "sql8",
    "answer": "SELECT emp_name, join_date FROM employees WHERE join_date >= curdate()- interval 30 day ;"
  },
  {
    "id": "sql9",
    "answer": "SELECT full_address,regexp_substr(full_address,'[0-9]{6}') as pincode FROM user_addresses;"
  },
  {
    "id": "sql10",
    "answer": "SELECT MAX(salary) AS second_highest FROM employees WHERE salary < (SELECT MAX(salary) FROM employees);"
  },
  {
    "id": "sql11",
    "answer": "SELECT * FROM employees WHERE join_date >= DATE_SUB(CURDATE(), INTERVAL 6 MONTH);"
  },
  {
    "id": "sql12",
    "answer": "SELECT department_id, COUNT(*) AS emp_COUNT FROM employees GROUP BY department_id HAVING COUNT(*) > 5;"
  },
  {
    "id": "sql13",
    "answer": "SELECT * FROM employees e WHERE salary = (SELECT MAX(salary) FROM employees WHERE department_id = e.department_id);"
  },
  {
    "id": "sql14",
    "answer": "SELECT dept_name, COUNT(*) as emp_COUNT FROM employees GROUP BY dept_name having COUNT(*) > 3"
  },
  {
    "id": "sql15",
    "answer": "SELECT dept_name, AVG(salary) as AVG_salary FROM employees GROUP BY dept_name having AVG(salary) > 60000;"
  },
  {
    "id": "sql16",
    "answer": "SELECT * FROM employees WHERE salary > (SELECT AVG(salary) FROM employees);"
  },
  {
    "id": "sql17",
    "answer": "SELECT dept_name,COUNT(*) as empl_COUNT FROM employees GROUP BY dept_name having COUNT(*) >= 1;"
  },
  {
    "id": "sql18",
    "answer": "SELECT emp_name, dept_name FROM employees WHERE dept_name in (SELECT dept_name FROM employees WHERE emp_name = 'Aman');"
  },
  {
    "id": "sql19",
    "answer": "SELECT emp_name, dept_name, salary FROM employees e WHERE salary = (SELECT MAX(salary) FROM employees WHERE dept_name = e.dept_name); "
  },
  {
    "id": "sql20",
    "answer": "SELECT e1.emp_id, e1.dept_name, e1.salary FROM employees e1 JOIN employees e2 on e2.emp_id = e1.manager_id WHERE e1.salary > e2.salary;"
  },
  {
    "id": "sql21",
    "answer": "SELECT dIStinct month(order_date) as Months,SUM(sales_amount) OVER(partition by month(order_date)) as Revenue FROM monthly_sales;"
  },
  {
    "id": "sql22",
    "answer": "SELECT product_name, selling_price - cost_price as diff_amount, case when selling_price > cost_price then 'Profit' when selling_price < cost_price then 'Loss' else 'no profit no loss' end as p_vs_l_label FROM inventory;"
  },
  {
    "id": "sql23",
    "answer": "SELECT *, SUM(salary)OVER(partition by dept_name ORDER BY salary desc) as cumulative_salary FROM employees;"
  },
  {
    "id": "sql24",
    "answer": "SELECT emp_name, joining_date FROM employees WHERE joining_date in (SELECT joining_date FROM employees GROUP BY joining_date having COUNT(*) > 1) ORDER BY joining_date asc;"
  },
  {
    "id": "sql25",
    "answer": "SELECT emp_id,prev_emp_id,gap_emp_id FROM (SELECT emp_id, LAG(emp_id) OVER(ORDER BY emp_id) as prev_emp_id, emp_id - LAG(emp_id) OVER(ORDER BY emp_id) as gap_emp_id FROM employees) t WHERE gap_emp_id > 1;"
  },
  {
    "id": "sql26",
    "answer": "SELECT dept_id, ROUND(variance(salary),2) as salary_variance FROM employees GROUP BY dept_id ORDER BY ROUND(variance(salary),2) desc limit 1;"
  },
  {
    "id": "sql27",
    "answer": "SELECT e1.emp_id, e1.emp_name FROM employees e1 join employees e2 on e2.emp_id = e1.manager_id AND e2.emp_id IS NULL;"
  },
  {
    "id": "sql28",
    "answer": "SELECT * FROM employees e WHERE salary > (SELECT AVG(salary) FROM employees WHERE department_id = e.department_id);"
  },
  {
    "id": "sql29",
    "answer": "SELECT * FROM (SELECT e.*, DENSE_RANK() OVER (PARTITION BY department_id ORDER BY salary DESC) AS rnk FROM employees e) t WHERE rnk <= 3;"
  },
  {
    "id": "sql30",
    "answer": "SELECT department_id FROM employees GROUP BY department_id HAVING MIN(salary) >= 30000;"
  },
  {
    "id": "sql31",
    "answer": "SELECT emp_name, dept_name, salary FROM (SELECT emp_name, dept_name, salary,dense_rank() OVER(partition by dept_name ORDER BY salary desc) as ranks FROM employees) rank_t WHERE ranks = 2;"
  },
  {
    "id": "sql32",
    "answer": "SELECT dIStinct joining_date, SUM(salary) OVER(ORDER BY joining_date) as total_of_salary FROM employees;"
  },
  {
    "id": "sql33",
    "answer": "SELECT emp_name, dept_name, salary, AVG(salary) OVER(partition by dept_name) as AVG_salary FROM employees;"
  },
  {
    "id": "sql34",
    "answer": "delete FROM employees WHERE emp_id in (SELECT emp_id FROM (SELECT emp_id, row_number() OVER(partition by emp_name, dept_name ORDER BY emp_id ) as rn FROM employees) s_no WHERE rn > 1);"
  },
  {
    "id": "sql35",
    "answer": "SELECT emp_name, dept_name, joining_date FROM (SELECT emp_name, dept_name, joining_date, \nLAG(joining_date) OVER(partition by dept_name ORDER BY joining_date) as prev_date FROM employees)\nimm_date WHERE joining_date = prev_date;"
  },
  {
    "id": "sql36",
    "answer": "SELECT emp_id, emp_name, dept_name ,salary, salary - LAG(salary) OVER(partition by dept_name ORDER BY salary asc) as diff_salary FROM employees;"
  },
  {
    "id": "sql37",
    "answer": "SELECT *, coalesce(salary ,0) as salary_update FROM sql_emp;"
  },
  {
    "id": "sql38",
    "answer": "SELECT dIStinct dept_name FROM (SELECT dept_name,months, emp_COUNT,LAG(emp_COUNT) OVER(partition by dept_name ORDER BY months) as prev_emp_COUNT FROM (SELECT dept_name, DATE_FORMAT(joining_date, '%Y-%m') as months, COUNT(emp_id) as emp_COUNT FROM employees GROUP BY dept_name, DATE_FORMAT(joining_date, '%Y-%m')) a )b WHERE emp_COUNT < prev_emp_COUNT"
  },
  {
    "id": "sql39",
    "answer": "with s_no as (SELECT customer_id, row_number()OVER(partition by customer_id ORDER BY customer_id) as cust_id FROM customer_orders)delete FROM customer_orders WHERE customer_id in (SELECT customer_id FROM s_no WHERE cust_id > 1 );"
  },
  {
    "id": "sql40",
    "answer": "with month_orders as (SELECT customer_id, DATE_FORMAT(order_date, '%Y-%m') as order_month FROM customer_orders) SELECT customer_id FROM \n(SELECT customer_id, order_month, LAG(order_month) OVER(partition by customer_id ORDER BY order_month) as prev_date FROM month_orders) prev_table WHERE timestampdiff(month, str_to_date(prev_date,'%Y-%m') ,str_to_date(order_month,'%Y-%m')) = 1;"
  },
  {
    "id": "sql41",
    "answer": "SELECT emp_name, dept_name, salary, joining_date FROM (SELECT emp_name, dept_name, salary, joining_date ,LAG(salary)OVER(ORDER BY joining_date) as prev_salary FROM employees) t WHERE salary < prev_salary;"
  },
  {
    "id": "sql42",
    "answer": "SELECT emp_name, dept_name, salary, joining_date FROM ( SELECT emp_name, dept_name, salary, joining_date, FROM_unixtime(AVG(unix_timestamp(joining_date))OVER(partition by dept_name)) as AVG_joining_date FROM employees )t WHERE joining_date > AVG_joining_date;"
  },
  {
    "id": "sql43",
    "answer": "with month as (SELECT DATE_FORMAT(sale_date, '%Y-%m') as months, SUM(amount) as total_amount FROM sales GROUP BY DATE_FORMAT(sale_date, '%Y-%m')) SELECT months, total_amount,LAG(total_amount)OVER(ORDER BY months) as prev_month, ROUND((total_amount - LAG(total_amount)OVER(ORDER BY months)) / LAG(total_amount)OVER(ORDER BY months) * 100) as mom_growth FROM month;"
  },
  {
    "id": "sql44",
    "answer": "SELECT customer_id ,MAX(sale_date) as last_sale_date FROM sales GROUP BY customer_id having MAX(sale_date) < date_sub(current_date(),interval 3 month);"
  },
  {
    "id": "sql45",
    "answer": "with product_sale as (\nSELECT product_id , SUM(amount) as total_sale, product_name FROM sales s JOIN products p using (product_id) GROUP BY product_id,product_name )SELECT product_id,product_name, total_sale, ROUND(total_sale * 100 / SUM(total_sale)OVER(),2) as pct_sales FROM product_sale;"
  },
  {
    "id": "sql46",
    "answer": "with cu as (SELECT year(joining_date) as years,department, COUNT(employee_id) as emp_COUNT FROM employees GROUP BY year(joining_date) ,department) SELECT years, department, emp_COUNT FROM (SELECT years, department, emp_COUNT, LAG(emp_COUNT)OVER(partition by department ORDER BY years) as prev_emp_COUNT FROM cu)t WHERE emp_COUNT < prev_emp_COUNT;"
  },
  {
    "id": "sql47",
    "answer": "with current_month as (SELECT DATE_FORMAT(sale_date, '%Y-%m') as months, customer_id, SUM(amount) as total_sale FROM sales GROUP BY DATE_FORMAT(sale_date, '%Y-%m'), customer_id) SELECT months, customer_id,total_sale,prev_total_sale FROM (SELECT months, customer_id,total_sale, LAG(total_sale)OVER(partition by customer_id ORDER BY months) as prev_total_sale FROM current_month)t WHERE total_sale > prev_total_sale;"
  },
  {
    "id": "sql48",
    "answer": "with last_txn_date as(SELECT customer_id,txn_date, LAG(txn_date, 1)OVER(partition by customer_id ORDER BY txn_date) as prev1,LAG(txn_date, 2)OVER(partition by customer_id ORDER BY txn_date) as prev2 FROM transactions)SELECT customer_id FROM last_txn_date WHERE txn_date = date_add(prev1, interval 1 day) AND prev1 = date_add(prev2, interval 1 day);"
  },
  {
    "id": "sql49",
    "answer": "with cte as (SELECT salary, row_number()OVER(ORDER BY salary) as rnk, COUNT(*)OVER() as total_count FROM employees) SELECT AVG(salary) as median_salary FROM cte WHERE rnk in ((floor((total_count+1) /2)), ceil((total_count+1) / 2));"
  },
  {
    "id": "sql50",
    "answer": "with month as (SELECT DATE_FORMAT(sale_month,'%Y-%m') as months, sale_id as cust_id, product_id FROM sales) SELECT months, cust_id FROM \n(SELECT months, cust_id,LAG(cust_id)OVER(partition by cust_id ORDER BY months) as prev_sale FROM month)t WHERE months = date_sub(prev_sale, interval 1 month);"
  },
  {
    "id": "sql51",
    "answer": "SELECT user_id, login_date FROM (SELECT user_id, login_date, LAG(login_date)OVER(partition by user_id ORDER BY login_date) as prev_login_dt FROM logins)t WHERE login_date > date_add(prev_login_dt, interval 1 day);"
  },
  {
    "id": "sql52",
    "answer": "with ipl_team as (SELECT team1 as Team, winner FROM ipl_match union all SELECT team2 as Team,winner FROM ipl_match )SELECT dIStinct Team, COUNT(*) as matchs,COUNT(case when Team = winner then 1 end) as win_count, COUNT(*) - COUNT(case when Team = winner then 1 end) as loss_COUNT FROM ipl_team GROUP BY Team ORDER BY matchs desc;"
  }
]